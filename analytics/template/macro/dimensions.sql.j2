{%- macro date(column, level) -%}
    {%- if level == 'month' -%}
    DATE_TRUNC({{ column }}, MONTH)
    {%- elif level == 'week' -%}
    DATE_TRUNC({{ column }}, WEEK)
    {%- else -%}
    {{ column }}
    {%- endif -%}
{%- endmacro -%}


{%- macro breakdown(by) -%}
    {%- if by == 'bedrooms_total' -%}
    BedroomsTotal AS bedrooms_total,
    {%- elif by == 'type' -%}
    PropertySubType AS property_sub_type,
    {%- elif by == 'postal_code' -%}
    PostalCode AS postal_code,
    {%- endif %}
{%- endmacro %}

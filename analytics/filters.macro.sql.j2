{%- macro geo(country, city) -%}
    {%- if country -%}
    AND Country IN ({{ country|map("quote")|join(",") }})
    {%- endif -%}
    {%- if city -%}
    AND City IN ({{ city|map("quote")|join(",") }})
    {%- endif -%}
{%- endmacro -%}

{%- macro market_date(start, end) -%}
    AND OnMarketDate <= {{ end|quote }}
    AND (OffMarketDate >= {{ start|quote }} OR ContingentDate >= {{ start|quote }})
{%- endmacro -%}
